"use strict";const formTask=document.getElementById("formTask"),tasksList=document.getElementById("tasksList"),fragment=document.createDocumentFragment(),validateFields=e=>{for(const t in e)if(e.hasOwnProperty(t)){const s=e[t];if(""===s||void 0===s)return!1}return!0},showMsg=(e,t)=>{const s=document.getElementById(e);s.textContent=t,setTimeout(()=>{s.textContent="Tareas"},2500)},colors={red:formTask.red,yellow:formTask.yellow,green:formTask.green},isColorChecked=()=>{for(const e in colors)if(colors.hasOwnProperty(e)){const t=colors[e];if(t.checked)return t.id}return!1},validateDate=e=>{const t=new Date;return new Date(e)-t>=0},setIdTask=()=>{const e=getCurrentTime();return`${e.year}${e.month}${e.date}${e.hours}${e.minutes}${e.seconds}`},getCurrentTime=()=>{let e=new Date;return{year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate(),hours:("0"+e.getHours()).slice(-2),minutes:("0"+e.getMinutes()).slice(-2),seconds:("0"+e.getSeconds()).slice(-2)}},showCurrentTime=()=>{let e=getCurrentTime();return`Agregada: ${e.date}/${e.month}/${e.year} a las ${e.hours}:${e.minutes}`},getRemainTime=e=>{let t=new Date,s=(new Date(e)-t+1e3)/1e3;return{remainTime:s,seconds:("0"+Math.floor(s%60)).slice(-2),minutes:("0"+Math.floor(s/60%60)).slice(-2),hours:("0"+Math.floor(s/3600%24)).slice(-2),days:Math.floor(s/86400)}},countDown=(e,t)=>{const s=setInterval(()=>{let a=getRemainTime(e);a.remainTime<=1&&clearInterval(s),t.textContent=`Quedan: ${a.days}d ${a.hours}h ${a.minutes}m ${a.seconds}s`},1e3)},ls=localStorage,setTasks=e=>{if(null===ls.getItem("tasks")){let t=[];t.push(e),ls.setItem("tasks",JSON.stringify(t))}else{let t=JSON.parse(ls.getItem("tasks"));t.push(e),ls.setItem("tasks",JSON.stringify(t))}showTasks()},showTasks=()=>{let e=JSON.parse(ls.getItem("tasks"));for(;tasksList.firstChild;)tasksList.removeChild(tasksList.firstChild);null!==ls.getItem("tasks")&&e.forEach(e=>{const t=document.createElement("LI");t.classList.add("tasks__task",""+e.bgColor);const s=document.createElement("P");s.classList.add("child-one"),s.textContent=""+e.name;const a=document.createElement("BUTTON");a.classList.add("child-two","button","delete"),a.textContent="Borrar";const n=document.createElement("P");n.classList.add("child-tree"),n.textContent=""+showCurrentTime();const o=document.createElement("P");o.classList.add("child-four"),countDown(e.date,o),t.appendChild(s),t.appendChild(a),t.appendChild(n),t.appendChild(o),fragment.appendChild(t),tasksList.appendChild(fragment)})},removeTask=e=>{let t=JSON.parse(ls.getItem("tasks"));for(const s of t)s.name===e&&t.splice(s,1);ls.setItem("tasks",JSON.stringify(t)),showTasks()};formTask.addEventListener("submit",e=>{e.preventDefault();const t={id:setIdTask(),name:formTask.inputTask.value.trim(),bgColor:isColorChecked(),date:formTask.inputDate.value};validateFields(t)?validateDate(t.date)?setTasks(t):showMsg("msg","La fecha debe ser posterior a hoy"):showMsg("msg","Completa todos los campos")}),tasksList.addEventListener("click",e=>{"Borrar"===e.target.textContent&&removeTask(e.target.previousSibling.textContent)}),document.addEventListener("DOMContentLoaded",()=>{showTasks()});